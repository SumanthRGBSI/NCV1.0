<section class="container">
  <link rel="stylesheet" href="/assets/8d.css">
  <div class="card header toolbar">
    <div>
      <div class="h-title">D6 â€” Implement & Validate Corrective Actions ðŸš€</div>
      <div class="h-sub">Implement the permanent solutions and prove they work.</div>
    </div>
    <div class="controls">
      <div class="timestamp">Last updated: <span id="d6-timestamp">Never</span></div>
      <select id="d6-status-select" class="input select-compact status-select" data-id="d6">
        <option value="pending">Pending</option>
        <option value="in-progress">In Progress</option>
        <option value="completed">Completed</option>
      </select>
    </div>
  </div>

  <div class="card">
    <div class="section-title">6A. Implementation Tracking</div>
    <table id="d6-impl" class="table dynamic-table">
      <thead><tr><th>Permanent Corrective Action</th><th>Target Date</th><th>Error Proofing Type</th><th>Level</th><th>Score</th><th>Responsibility</th><th>Effectiveness</th><th>Status</th><th></th></tr></thead>
      <tbody></tbody>
      <tfoot><tr><td colspan="9"><button class="add-row-btn btn btn-ghost">Add Implementation</button></td></tr></tfoot>
      <template>
        <tr>
          <td><input class="input impl-action"/></td>
          <td><input class="input" type="date"/></td>
          <td>
            <select class="input impl-etype">
              <option>Detection</option>
              <option>Warning</option>
              <option>Control</option>
              <option>Shutdown</option>
            </select>
          </td>
          <td><input class="input impl-level" type="number" min="1" max="5"/></td>
          <td><input class="input impl-score" type="number" disabled /></td>
          <td><input class="input"/></td>
          <td><input class="input"/></td>
          <td><input class="input"/></td>
          <td><button class="remove-row-btn btn btn-danger">Remove</button></td>
        </tr>
      </template>
    </table>

    <div class="card mt-small">
      <div class="section-title">KPI Dashboard</div>
      <div class="row mt-small">
        <div class="col">
          <label class="label">Defect Rate (Before / After)</label>
          <div class="controls"><input id="kpi-def-before" class="input" type="number" placeholder="Before"/><input id="kpi-def-after" class="input" type="number" placeholder="After"/></div>
          <div id="kpi-def-chart" class="mt-xs" style="height:12px;background:#f1f5f9;border-radius:8px;position:relative"><div id="kpi-def-bar" style="position:absolute;left:0;top:0;bottom:0;background:var(--success);width:0%;border-radius:8px"></div></div>
        </div>
        <div class="col">
          <label class="label">RPN (Before / After)</label>
          <div class="controls"><input id="kpi-rpn-before" class="input" type="number" placeholder="Before"/><input id="kpi-rpn-after" class="input" type="number" placeholder="After"/></div>
          <div id="kpi-rpn-chart" class="mt-xs" style="height:12px;background:#f1f5f9;border-radius:8px;position:relative"><div id="kpi-rpn-bar" style="position:absolute;left:0;top:0;bottom:0;background:var(--success);width:0%;border-radius:8px"></div></div>
        </div>
      </div>
    </div>

    <label class="label mt-small">6B. Proof of Effectiveness</label>
    <textarea id="d6-proof" class="input"></textarea>

    <label class="label mt-small">6C. Situation After Countermeasure</label>
    <textarea id="d6-situationAfter" class="input"></textarea>

    <div class="mt-small">
      <label class="label">6D. Situation After (Graphs / Images)</label>
      <div class="file-block drop-zone">
        <input id="d6-after-graphs" class="preview-file" type="file" multiple />
        <div class="file-preview small"></div>
      </div>
    </div>

    <div class="mt-small">
      <div class="section-title">Before vs After Comparison</div>
      <div class="row">
        <div class="col">
          <div class="small">Before (from D2)</div>
          <div id="d6-compare-before" class="card" style="padding:.5rem"></div>
        </div>
        <div class="col">
          <div class="small">After (D6)</div>
          <div id="d6-compare-after" class="card" style="padding:.5rem"></div>
        </div>
      </div>
    </div>

    <div class="mt-small">
      <div class="section-title">6E. Improvement Verification</div>
      <table id="d6-verify" class="table dynamic-table">
        <thead><tr><th>Element</th><th>YES/NO</th><th>Comments</th><th></th></tr></thead>
        <tbody></tbody>
        <tfoot><tr><td colspan="4"><button class="add-row-btn btn btn-ghost">Add Verification Item</button></td></tr></tfoot>
        <template>
          <tr><td><input class="input"/></td><td><select class="input"><option>Yes</option><option>No</option></select></td><td><input class="input"/></td><td><button class="remove-row-btn btn btn-danger">Remove</button></td></tr>
        </template>
      </table>
      <div class="controls mt-xs"><button id="d6-approve" class="btn btn-primary" aria-label="Manager sign off"><i data-lucide="check"></i> Manager Sign-off</button></div>
      <div id="d6-approval-status" class="small mt-xs"></div>
    </div>

    <div class="mt-small">
      <label class="label">6F. Documents</label>
      <div class="file-block drop-zone">
        <input class="preview-file" type="file" multiple />
        <div class="file-preview small"></div>
      </div>
    </div>
  </div>

  <script src="/assets/8d-forms.js"></script>
  <script>window.__init8D && window.__init8D(document);</script>
</section>
