<section class="container">
  <link rel="stylesheet" href="../assets/8d.css">
  <div class="card header toolbar">
    <div>
      <div class="h-title">D7 ‚Äî Prevent Recurrence üõ°Ô∏è</div>
      <div class="h-sub">Systemic changes to prevent recurrence.</div>
    </div>
    <div class="controls">
      <div class="timestamp">Last updated: <span id="d7-timestamp">Never</span></div>
      <select id="d7-status-select" class="input select-compact status-select" data-id="d7">
        <option value="pending">Pending</option>
        <option value="in-progress">In Progress</option>
        <option value="completed">Completed</option>
      </select>
    </div>
  </div>

  <div class="card">
    <div class="section-title">Preventive Actions</div>
    <table id="d7-prevent-slim" class="table dynamic-table table-alt">
      <thead><tr><th>Action</th><th>Owner</th><th>Due Date</th><th>Status</th><th></th></tr></thead>
      <tbody></tbody>
      <tfoot><tr><td colspan="5"><button class="add-row-btn btn btn-ghost">+ New Preventive Action</button></td></tr></tfoot>
      <template>
        <tr class="d7-row">
          <td><input class="input d7-action"/></td>
          <td><input class="input d7-owner"/></td>
          <td><input class="input d7-date" type="date"/></td>
          <td><select class="input prevent-status"><option>Planned</option><option>In Progress</option><option>Done</option></select></td>
          <td><button class="btn btn-ghost d7-expand">Details</button> <button class="remove-row-btn btn btn-danger">Remove</button></td>
        </tr>
      </template>
    </table>
    <div id="d7-detail" class="card" style="display:none">
      <div class="row">
        <div class="col">
          <label class="label">RPN (S,O,D)</label>
          <div class="controls">
            <input class="input rpn-s" type="number" min="1" max="10" placeholder="S"/>
            <input class="input rpn-o" type="number" min="1" max="10" placeholder="O"/>
            <input class="input rpn-d" type="number" min="1" max="10" placeholder="D"/>
          </div>
          <div class="small">Revised RPN: <strong id="d7-rpn-val">0</strong></div>
        </div>
        <div class="col">
          <label class="label">Type</label>
          <select class="input d7-type">
            <option selected>Prevent</option>
            <option>Detect</option>
            <option>Control</option>
            <option>Training</option>
            <option>Other</option>
          </select>
          <label class="label mt-small">Documents</label>
          <div class="file-block drop-zone">
            <input class="preview-file" type="file" multiple />
            <div class="file-preview small"></div>
          </div>
        </div>
      </div>
      <div class="mt-small"><label class="label">Related (FMEA, Control Plan, SOPs‚Ä¶)</label><div id="d7-std-list" class="dynamic-list"></div></div>
    </div>
  </div>

  <div class="card">
    <div class="section-title">Read & Understood</div>
    <div id="d7-ack-bar" class="small">0 of 0 acknowledged</div>
    <div class="mt-small"><button id="d7-view-acks" class="btn btn-ghost">View Details</button></div>
  </div>

  <script src="../assets/8d-forms.js"></script>
  <script>window.__init8D && window.__init8D(document);</script>
</section>
